(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{29:function(n,t,e){},30:function(n,t,e){},41:function(n,t,e){"use strict";e.r(t);var r=e(1),c=e(0),a=e(20),o=e.n(a),i=(e(29),e(4)),u=e(2),s=(e(30),e(3)),j=e(7),l=e(5),b="https://student-json-api.lidemy.me",d=function(){return fetch("".concat(b,"/posts?_sort=createdAt&_order=desc")).then((function(n){return n.json()}))},f=function(){var n=localStorage.getItem("token");return fetch("".concat(b,"/me"),{headers:{authorization:"Bearer ".concat(n)}}).then((function(n){return n.json()}))},O=function(n){return fetch("".concat(b,"/posts?_sort=createdAt&_order=desc&_page=").concat(n,"&_limit=5")).then((function(n){return n.json()}))};function p(){var n=Object(u.a)(["\n  color: rgba(0, 0, 0, 0.8)\n"]);return p=function(){return n},n}function h(){var n=Object(u.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n"]);return h=function(){return n},n}function x(){var n=Object(u.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]);return x=function(){return n},n}function v(){var n=Object(u.a)(["\n  width: 80%;\n  margin: auto;\n  margin-top: 64px;\n"]);return v=function(){return n},n}var g=s.a.div(v()),m=s.a.div(x()),y=Object(s.a)(j.b)(h()),S=s.a.div(p());function k(n){var t=n.post;return Object(r.jsxs)(m,{children:[Object(r.jsx)(y,{to:"/posts/".concat(t.id),children:t.title}),Object(r.jsx)(S,{children:new Date(t.createdAt).toLocaleString()})]})}var w=function(){var n=Object(c.useState)([]),t=Object(i.a)(n,2),e=t[0],a=t[1];return Object(c.useEffect)((function(){d().then((function(n){return a(n)}))}),[]),Object(r.jsxs)(g,{children:[e.map((function(n){return Object(r.jsx)(k,{post:n},n.id)})),Object(r.jsx)(j.a,{children:Object(r.jsx)(l.c,{children:Object(r.jsx)(l.a,{path:"/post/:id",children:"123"})})})]})},C=Object(c.createContext)(null);function z(){var n=Object(u.a)(["\n  color: red;\n"]);return z=function(){return n},n}function I(){var n=Object(u.a)(["\n  margin-top: 64px;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n"]);return I=function(){return n},n}var $=s.a.div(I()),A=s.a.div(z());var D=function(){var n=Object(c.useContext)(C).setUser,t=Object(c.useState)(""),e=Object(i.a)(t,2),a=e[0],o=e[1],u=Object(c.useState)(""),s=Object(i.a)(u,2),j=s[0],d=s[1],O=Object(c.useState)(null),p=Object(i.a)(O,2),h=p[0],x=p[1],v=Object(l.f)(),g=Object(l.g)();return Object(r.jsx)($,{children:Object(r.jsxs)("form",{onSubmit:function(t){x(null),t.preventDefault(),function(n,t){return fetch("".concat(b,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:n,password:t})}).then((function(n){return n.json()}))}(a,j).then((function(t){if(0===t.ok)return x(t.message),void console.log("logining error");var e=t.token;localStorage.setItem("token",e),f().then((function(t){if(1!==t.ok)return console.log("response not ok",t.message),localStorage.setItem("token",null),console.log("token error"),x(t.toString());n(t.data),"/"!==g.pathname&&v.push("/")}))}))},children:[Object(r.jsxs)("div",{children:["username: ",Object(r.jsx)("input",{value:a,onChange:function(n){return o(n.target.value)}})]}),Object(r.jsxs)("div",{children:["password: ",Object(r.jsx)("input",{type:"password",value:j,onChange:function(n){return d(n.target.value)}})]}),Object(r.jsx)("button",{children:" \u767b\u5165 "}),h&&Object(r.jsxs)(A,{children:[" ",h," "]})]})})};function _(){var n=Object(u.a)([" \n  margin-top: 20px;\n  font-size: 16px;\n  padding: 0px 20px;\n"]);return _=function(){return n},n}function E(){var n=Object(u.a)([""]);return E=function(){return n},n}function J(){var n=Object(u.a)(["\n  font-size: 24px;\n"]);return J=function(){return n},n}function L(){var n=Object(u.a)(["\n  padding: 10px 5px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  \n"]);return L=function(){return n},n}function T(){var n=Object(u.a)(["\n  \n  margin: auto;\n  width: 60%;\n"]);return T=function(){return n},n}function P(){var n=Object(u.a)(["\n  margin-top: 80px;\n"]);return P=function(){return n},n}var U=function(){var n=Object(c.useState)({}),t=Object(i.a)(n,2),e=t[0],a=t[1],o=Object(l.h)().id;console.log(o),Object(c.useEffect)((function(){(function(n){return fetch("".concat(b,"/posts/").concat(n)).then((function(n){return n.json()}))})(o).then((function(n){console.log(n),a(n)}))}),[]);var u=s.a.div(P()),j=s.a.div(T()),d=s.a.div(L()),f=s.a.div(J()),O=s.a.div(E()),p=s.a.div(_());return Object(r.jsx)(u,{children:Object(r.jsxs)(j,{children:[Object(r.jsxs)(d,{children:[Object(r.jsx)(f,{children:e.title}),Object(r.jsx)(O,{children:new Date(e.createdAt).toLocaleString()})]}),Object(r.jsx)(p,{children:e.body})]})})};function B(){var n=Object(u.a)(["\n    padding: 5px 10px;\n    cursor: pointer;\n   \n  "]);return B=function(){return n},n}function N(){var n=Object(u.a)(["\n    margin-top: 20px;\n    display: flex;\n    justify-content: center;\n  "]);return N=function(){return n},n}function M(){var n=Object(u.a)(["\n    color: rgba(0, 0, 0, 0.8)\n  "]);return M=function(){return n},n}function q(){var n=Object(u.a)(["\n    font-size: 24px;\n    color: #333;\n    text-decoration: none;\n  "]);return q=function(){return n},n}function F(){var n=Object(u.a)(["\n    border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n    padding: 16px;\n    display: flex;\n    align-items: flex-end;\n    justify-content: space-between;\n  "]);return F=function(){return n},n}function G(){var n=Object(u.a)(["\n    margin-top: 80px;\n  "]);return G=function(){return n},n}var H=function(){var n=Object(c.useState)([]),t=Object(i.a)(n,2),e=t[0],a=t[1],o=Object(c.useState)([]),u=Object(i.a)(o,2),l=u[0],b=u[1];Object(c.useEffect)((function(){d().then((function(n){b(Array(Math.ceil(n.length/5)).fill("1"))})),O(1).then((function(n){a(n)}))}),[]);var f=Object(c.useCallback)((function(n){O(n).then((function(n){console.log(n),a(n)}))})),p=s.a.div(G()),h=s.a.div(F()),x=Object(s.a)(j.b)(q()),v=s.a.div(M()),g=s.a.div(N()),m=s.a.div(B()),y=function(n){var t=n.target.innerText;f(t)};return Object(r.jsxs)(p,{children:[" ",e.map((function(n){return Object(r.jsxs)(h,{children:[Object(r.jsxs)(x,{to:"/posts/".concat(n.id),children:[" ",n.title," "]}),Object(r.jsxs)(v,{children:[" ",new Date(n.createdAt).toLocaleString()," "]})]})})),Object(r.jsxs)(g,{children:[" ",l.map((function(n,t){return Object(r.jsx)(m,{onClick:y,children:t+1})}))]})]})};function K(){var n=Object(u.a)(["\n  width: 70%;\n  margin: auto;\n  border: 1px solid rgba(0, 0, 0, 0.3);\n  border-radius: 7px;\n  text-align: center;\n  padding: 50px 20px;\n"]);return K=function(){return n},n}function Q(){var n=Object(u.a)(["\n  margin-top: 64px;\n"]);return Q=function(){return n},n}var R=s.a.div(Q()),V=s.a.div(K());var W=function(){var n=Object(c.useState)(""),t=Object(i.a)(n,2),e=t[0],a=t[1],o=Object(c.useState)(""),u=Object(i.a)(o,2),s=u[0],j=u[1],d=Object(l.f)();return Object(r.jsx)(R,{children:Object(r.jsx)(V,{children:Object(r.jsxs)("form",{onSubmit:function(n){n.preventDefault(),function(n,t){var e=localStorage.getItem("token");return fetch("".concat(b,"/posts"),{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer ".concat(e)},body:JSON.stringify({title:n,body:t})}).then((function(n){return n.json()}))}(e,s).then((function(n){0!==n.ok&&(console.log(n),d.push("/"))}))},children:[Object(r.jsxs)("div",{children:["Title: ",Object(r.jsx)("input",{value:e,onChange:function(n){return a(n.target.value)}})]}),Object(r.jsxs)("div",{children:["body: ",Object(r.jsx)("input",{value:s,onChange:function(n){return j(n.target.value)}})]}),Object(r.jsx)("button",{type:"submit",children:" \u767c\u5e03\u6587\u7ae0 "})]})})})};function X(){var n=Object(u.a)(["\n  width: 80%;\n  margin: auto;\n  margin-top: 64px;\n"]);return X=function(){return n},n}var Y=s.a.div(X());var Z=function(){return Object(r.jsx)(Y,{children:"\u96a8\u610f\u986f\u793a\u4e00\u4e9b\u95dc\u65bc\u9019\u500b\u90e8\u843d\u683c\u7684\u8a71 \u96a8\u610f\u986f\u793a\u4e00\u4e9b\u95dc\u65bc\u9019\u500b\u90e8\u843d\u683c\u7684\u8a71 \u96a8\u610f\u986f\u793a\u4e00\u4e9b\u95dc\u65bc\u9019\u500b\u90e8\u843d\u683c\u7684\u8a71 \u96a8\u610f\u986f\u793a\u4e00\u4e9b\u95dc\u65bc\u9019\u500b\u90e8\u843d\u683c\u7684\u8a71 \u96a8\u610f\u986f\u793a\u4e00\u4e9b\u95dc\u65bc\u9019\u500b\u90e8\u843d\u683c\u7684\u8a71"})};function nn(){var n=Object(u.a)(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  left: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  color: white;\n  z-index: 10;\n  font-size: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]);return nn=function(){return n},n}function tn(){var n=Object(u.a)(["\n  color: red;\n"]);return tn=function(){return n},n}function en(){var n=Object(u.a)(["\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n"]);return en=function(){return n},n}function rn(){var n=Object(u.a)(["\n  margin-top: 64px;\n\n"]);return rn=function(){return n},n}var cn=s.a.div(rn()),an=s.a.form(en()),on=s.a.div(tn()),un=s.a.div(nn());var sn=function(){var n=Object(c.useContext)(C).setUser,t=Object(c.useState)(""),e=Object(i.a)(t,2),a=e[0],o=e[1],u=Object(c.useState)(""),s=Object(i.a)(u,2),j=s[0],d=s[1],f=Object(c.useState)(""),O=Object(i.a)(f,2),p=O[0],h=O[1],x=Object(c.useState)(null),v=Object(i.a)(x,2),g=v[0],m=v[1],y=Object(c.useState)(!1),S=Object(i.a)(y,2),k=S[0],w=S[1],z=Object(l.f)();return Object(r.jsxs)(cn,{children:[k&&Object(r.jsx)(un,{children:" Loading...... "}),Object(r.jsxs)(an,{onSubmit:function(t){if(t.preventDefault(),m(null),!k){if(w(!0),!a||!j||!p)return alert("\u8acb\u586b\u5beb\u5b8c\u6574\uff01"),void w(!1);(function(n,t,e){return fetch("".concat(b,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:n,username:t,password:e})}).then((function(n){return n.json()}))})(a,j,p).then((function(t){if(!t.ok)return m(t.message),void w(!1);n({nickname:a,username:j,password:p}),localStorage.setItem("token",t.token),w(!1),alert("\u8a3b\u518a\u6210\u529f"),z.push("/")})).catch((function(n){m(n)})),o(""),d(""),h("")}},children:[Object(r.jsxs)("div",{children:["nickname: ",Object(r.jsx)("input",{value:a,onChange:function(n){return o(n.target.value)}})]}),Object(r.jsxs)("div",{children:["username: ",Object(r.jsx)("input",{value:j,onChange:function(n){return d(n.target.value)}})]}),Object(r.jsxs)("div",{children:["password: ",Object(r.jsx)("input",{type:"password",value:p,onChange:function(n){return h(n.target.value)}})]}),Object(r.jsx)("button",{children:" \u63d0\u4ea4\u8a3b\u518a "}),g&&Object(r.jsxs)(on,{children:[" ",g," "]})]})]})};function jn(){var n=Object(u.a)(["\n  display: flex;\n\n  ","{\n    margin-left: 10px;  \n  }\n"]);return jn=function(){return n},n}function ln(){var n=Object(u.a)(["\n  display: flex;\n  justify-center: center;\n  align-items: center;\n  height: 64px;\n  padding: 0px 15px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n\n\n  ","\n"]);return ln=function(){return n},n}function bn(){var n=Object(u.a)(["\n  display: flex;\n  align-item: center;\n"]);return bn=function(){return n},n}function dn(){var n=Object(u.a)(["\n  display: flex;\n  font-size: 24px;\n  font-weight: bold;  \n  margin: auto;\n\n  &:hover {\n    color: yellow;\n  }\n"]);return dn=function(){return n},n}function fn(){var n=Object(u.a)(["\n  height: 64px;\n  position: fixed;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n  padding: 0px 32px;\n"]);return fn=function(){return n},n}var On=s.a.div(fn()),pn=s.a.div(dn()),hn=s.a.div(bn()),xn=Object(s.a)(j.b)(ln(),(function(n){return n.$active&&"\n    background: rgba(0, 0, 0, 0.1)\n  "})),vn=s.a.div(jn(),hn);var gn=function(){var n=Object(c.useContext)(C),t=n.user,e=n.setUser,a=Object(l.g)(),o=Object(l.f)();return Object(r.jsxs)(On,{children:[Object(r.jsxs)(vn,{children:[Object(r.jsx)(pn,{children:"\u9019\u662f\u6211\u7b2c\u4e00\u500b\u90e8\u843d\u683c"}),Object(r.jsxs)(hn,{children:[Object(r.jsx)(xn,{to:"/",$active:"/"===a.pathname,children:"\u9996\u9801"}),Object(r.jsx)(xn,{to:"/about",$active:"/about"===a.pathname,children:"\u95dc\u65bc"}),Object(r.jsx)(xn,{to:"list-post",$active:"list-post"===a.pathname,children:" \u6587\u7ae0\u5217\u8868 "}),t&&Object(r.jsx)(xn,{to:"/new-post",$active:"/new-post"===a.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(r.jsxs)(hn,{children:[!t&&Object(r.jsx)(xn,{to:"/login",$active:"/login"===a.pathname,children:"\u767b\u5165"}),t&&Object(r.jsx)(xn,{onClick:function(){localStorage.setItem("token",null),o.push("/"),e(null)},children:" \u767b\u51fa "}),Object(r.jsx)(xn,{to:"/register",$active:"/register"===a.pathname,children:"\u8a3b\u518a"})]})]})};function mn(){var n=Object(u.a)([""]);return mn=function(){return n},n}var yn=s.a.div(mn());var Sn=function(){var n=Object(c.useState)(null),t=Object(i.a)(n,2),e=t[0],a=t[1];return Object(c.useLayoutEffect)((function(){f().then((function(n){n.ok&&a(n.data)}))}),[]),Object(r.jsx)(C.Provider,{value:{user:e,setUser:a},children:Object(r.jsx)(yn,{children:Object(r.jsxs)(j.a,{children:[Object(r.jsx)(gn,{}),Object(r.jsxs)(l.c,{children:[Object(r.jsx)(l.a,{exact:!0,path:"/",children:Object(r.jsx)(w,{})}),Object(r.jsx)(l.a,{path:"/about",children:Object(r.jsx)(Z,{})}),Object(r.jsx)(l.a,{path:"/list-post",children:Object(r.jsx)(H,{})}),Object(r.jsx)(l.a,{path:"/login",children:Object(r.jsx)(D,{})}),Object(r.jsx)(l.a,{path:"/posts/:id",children:Object(r.jsx)(U,{})}),Object(r.jsx)(l.a,{path:"/new-post",children:Object(r.jsx)(W,{})}),Object(r.jsx)(l.a,{path:"/register",children:Object(r.jsx)(sn,{})})]})]})})})};o.a.render(Object(r.jsx)(Sn,{}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.a17a5e99.chunk.js.map